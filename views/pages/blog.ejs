<div class="posts">
    <div class="container">
        <% if (posts.length > 0 ) { %>
            <% posts.forEach((el,i) => { %>
                
                <div class="pst">
                <div class="post">
                    <div class="admin">
                        <div class="pic"></div>
                        <div class="det">
                            <p style="margin-bottom: 8px;">Just Sew Team </p>
                            <p style="margin-top: 8px; color: #aaaaaabf;"><%= el.date %> </p>
                        </div>
                        
                    </div>
                    <div class="postContent" style="width: 100%; margin-bottom: 10px;">
                        <p><%= el.content %></p>
                    </div>
                    <div class="picture">
                        <div class="slider-container">
                            <button class="button previous disabled"><img src="images/chevron_left_black_24dp.svg" alt="" width="30px" height="30px"></button>
                            <div class="slider">
                                    
                                <% if (el.path1 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path1 %>" alt="" class="active" width="100%" height="100%">
                                <% } %> 
                                <% if (el.path2 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path2 %>" alt="" width="100%" height="100%">
                                    <% } %> 
                                <% if (el.path3 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path3 %>" alt="" width="100%" height="100%">
                                    <% } %> 
                                <% if (el.path4 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path4 %>" alt="" width="100%" height="100%">
                                    <% } %> 
                                <% if (el.path5 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path5 %>" alt="" width="100%" height="100%">
                                    <% } %> 
                                <% if (el.path6 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path6 %>" alt="" width="100%" height="100%">
                                    <% } %> 
                                <% if (el.path7 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path7 %>" alt="" width="100%" height="100%">
                                    <% } %> 
                                <% if (el.path8 !== "data:JPG;charset=utf-8;base64,") { %>
                                    <img src="<%= el.path8 %>" alt="" width="100%" height="100%">
                                    <% } %>

                            </div>
                            <button class="button next "><img src="../images/navigate_next_black_24dp.svg" alt="" width="30px" height="30px"></button>
                            <div class="slider-bulls">
                                <span id="indicators" class="indicators">
                                    
                                </span>
                            </div>
                            
                        </div>
                    </div>
                    <div class="icons">
                        
                        <form action="/liked?_method=PUT" method="post" class="lik">
                            <input type="hidden" name="postId" value="<%= el.id %>">
                            <input type="hidden" name="val" value="1">
                            <% if (!el.liked.includes(user.id)) { %>
                            <button ><i class="like" class="fa-regular fa-heart"></i></button>
                            <% } else {%>
                            <button ><i  class="fa-solid fa-heart like" style="color: red;"></i></button>
                            <% } %>  
                        </form>
                        
                        <button><i class="comicn" class="fa-regular fa-message"></i></button>
                        <button><i class="share" class="fa-regular fa-share"></i></button>
                    </div>
                    <p class="likes" style="width: 100%;"><i class="fa-solid fa-heart" style="font-size: 17px;"></i> <%= el.liked.length %> likes</p>
                </div>
                
                <div class="comments">
                    <div class="otherCom">
                            
                            <% comments.forEach(element => { %>
                                
                                <% if (element.postId.trim() === el.id.trim()) { %>
                                <div class="maincom">
                                    <div class="person">
                                        <img src="../images/account_circle_FILL0_wght400_GRAD0_opsz48.svg" alt="" width="50px" height="50px" style="border-radius: 50%; border: .5px solid black;">
                                        <p class="nom" style="margin-top:5px ;"> <%= element.userFName %>  </p>
                                        <p class="nom" style="margin-top:5px ;"> <%= element.userLName %>  </p>
                                    </div>
                                    <div class="otherContent">
                                        <p style="margin: 10px 0 0 5px;"> <%= element.content %></p>
                                        <div class="midl">
                                                <p class="rply"  style="display: inline-block; color: #A1CAF1;cursor: pointer;font-weight: bold;">Reply</p>
                                                <p class="date">publié le  <%= element.date %> </p>
                                        </div>
                                        
                                    </div>
                                </div>
                                <div class="repContai" style="display: none;">
                                    <% replies.forEach(ele => { %>
                                        <% if (ele.comId.trim() === element.id.trim()) { %>
                                            <div class="replies" >
                                                <div class="reply">
                                                        <div class="person">
                                                                <img src="../images/account_circle_FILL0_wght400_GRAD0_opsz48.svg" alt="" width="50px" height="50px" style="border-radius: 50%; border: .5px solid black;">
                                                                <p class="nom" style="margin-top:5px ;"> <%= ele.userFName %> </p>
                                                                <p class="nom" style="margin-top:5px ;"> <%= ele.userLName %> </p>
                                                            </div>
                                                            <div class="otherContent">
                                                                <p style="margin: 10px 0 0 5px;"> <%= ele.content %> </p>
                                                                <div class="midl" style="justify-content: flex-end;">
                                                                        <p class="date">publié le  <%= ele.date %> </p>
                                                                </div>
                                                            </div>
                                                            
                                                            
                                                </div>
                                            </div>
                                            
                                        <% } %>
                                    <% }) %>
                                    <form action="/blogRep" method="post" class="rep" style=" width:90%; margin: 0 auto;"> <!--flex -->
                                        <input type="hidden" name = "comId" id="count" value="<%= element.id %> ">
                                        <input type="text" name="comment" placeholder="Reply ... " >
                                        <button>Post</button>
                                    </form>
                                </div>
                                    
                                <% } %>
                            <% }) %>
                            
                            
                            
                    </div>
                    <div class="yourComm">
                        <form action="/blogCom" method="post">
                            <input type="hidden" name = "postId" id="count" value="<%= el.id %> ">
                            <input type="text" name="comment" class="urcom" placeholder="Add a comment ... ">
                            <div class="buttons">
                                <button>Post</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <% }) %>
            
        <% } else { %>
            <p class="notFound">There Is No Posts</p>
        <% } %> 
            <% if (user && user.owner === true) { %>
                <div class="createPost">
                        <h2>Create A Post :</h2>
                        <form action="/blog" method="post">
                            <label for="newPost" style="display: block; font-weight: bold;font-size: 20px;margin-bottom: 5px;">Post Content :</label>
                            <textarea name="newPost" id="newPost" placeholder="Type here ..."></textarea>
                            <input name="prodCover1" type="file" id="file1"  class="file filepond">
                            <input name="prodCover2" type="file" id="file1"  class="file filepond">
                            <input name="prodCover3" type="file" id="file1"  class="file filepond">
                            <input name="prodCover4" type="file" id="file1"  class="file filepond">
                            <input name="prodCover5" type="file" id="file1"  class="file filepond">
                            <input name="prodCover6" type="file" id="file1"  class="file filepond">
                            <input name="prodCover7" type="file" id="file1"  class="file filepond">
                            <input name="prodCover8" type="file" id="file1"  class="file filepond">
                            <div class="buttons" style="width: 100%;">
                                <button>Post</button>
                            </div>
                        </form>
                    </div>
            <% } %>
    </div>
    
</div>
<script src="/javascript/blog.js"></script>